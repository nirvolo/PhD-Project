"0","state = map_data(""state"")"
"0","# Illinois, Indiana, Iowa, Kansas, and Missouri: polygon data for states"
"0","midwest = state[state$region %in% c(""kansas"", ""missouri"", ""iowa"", ""illinois"", ""indiana""),]"
"0","unique(midwest$region)"
"1","[1]"
"1"," ""illinois"""
"1"," ""indiana"" "
"1"," ""iowa""    "
"1"," ""kansas""  "
"1"," ""missouri"""
"1","
"
"0","### Organizing the centroid data so that I can add the midw counties to the midwest map below"
"0","midw_cnty = counties(c(""Kansas"", ""Missouri"", ""Iowa"", ""Illinois"", ""Indiana""), cb = T)"
"2","Retrieving data for the year 2020
"
"2","Using FIPS code '20' for state 'Kansas'
"
"2","Using FIPS code '29' for state 'Missouri'
"
"2","Using FIPS code '19' for state 'Iowa'
"
"2","Using FIPS code '17' for state 'Illinois'
"
"2","Using FIPS code '18' for state 'Indiana'
"
"0","# This is the polygon data for counties in the US"
"0","cnty = map_data(""county"")"
"0","midw_cnty_poly = cnty[cnty$region %in% c(""kansas"", ""missouri"", ""iowa"", ""illinois"", ""indiana""),]"
"0","### Finding the centroids"
"0","midw_cent = st_centroid(st_geometry(midw_cnty))"
"0","midw_cent_df = data.frame(matrix(data = NA, nrow = length(midw_cent), ncol = 2))"
"0","for(i in 1:length(midw_cent)){"
"0","  midw_cent_df[i,] = midw_cent[[i]]"
"0","}"
"0","# Adding the group and state variable to the centroids"
"0","midw_cent_df[,""group""] = 0"
"0","midw_cent_df[,""state""] = midw_cnty$STATE_NAME"
"0","midw_st_group_code = matrix(c(""Illinois"", 12, ""Kansas"", 15, ""Iowa"", 14, ""Missouri"", 27, ""Indiana"", 13), nrow = 5, ncol = 2, byrow = T)"
"0","for(st in unique(midw_cent_df$state)){"
"0","  print(st)"
"0","  print(midw_st_group_code[midw_st_group_code[,1] == st, 2])"
"0","  midw_cent_df[midw_cent_df$state == st,""group""] = midw_st_group_code[midw_st_group_code[,1] == st, 2]"
"0","}"
"1","[1]"
"1"," ""Indiana"""
"1","
"
"1","[1]"
"1"," ""13"""
"1","
"
"1","[1]"
"1"," ""Kansas"""
"1","
"
"1","[1]"
"1"," ""15"""
"1","
"
"1","[1]"
"1"," ""Illinois"""
"1","
"
"1","[1]"
"1"," ""12"""
"1","
"
"1","[1]"
"1"," ""Missouri"""
"1","
"
"1","[1]"
"1"," ""27"""
"1","
"
"1","[1]"
"1"," ""Iowa"""
"1","
"
"1","[1]"
"1"," ""14"""
"1","
"
"0","colnames(midw_cent_df) = c(""long"",""lat"",""group"",""state"")"
"0","##### Creating a plot of the Midwest spatial domain with coresponding counties "
"0","ggplot(data = midwest, mapping = aes(x = long, y = lat, group = group)) +"
"0","  coord_fixed(1.3) + "
"0","  geom_polygon(color=""black"", fill=""gray"") + "
"0","  geom_polygon(data=midw_cnty_poly, fill=NA, color=""white"") + "
"0","  geom_point(data = midw_cent_df, aes(long, lat), col = ""red"", size = 0.5) + "
"0","  #ggtitle('Midwest Region with Counties') + "
"0","  theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank(),"
"0","        axis.title.y=element_blank(), axis.text.y=element_blank(), axis.ticks.y=element_blank())"
